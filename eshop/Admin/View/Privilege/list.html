<layout name="Index/header_foot"/>
<include file="index/list" />
<div class="page-container">
	<form >
    <p>搜索内容：
      <input type="text" style="width:120px;" class="input-text"  value="{$Think.get.search_val}" name="search_val">
      <span class="select-box" style="width:150px;">
      <select  class="select"   size="1" name="search_key" >
        <option value="">请选择搜索类型</option>
        <option value="id" <eq name="Think.get.search_key" value="id">selected</eq> >ID</option>
        <option value="pri_name" <eq name="Think.get.search_key" value="pri_name">selected</eq> >权限名称</option>
        <option value="moduel_name" <eq name="Think.get.search_key" value="moduel_name">selected</eq> >模块名称</option>
        <option value="controller_name" <eq name="Think.get.search_key" value="controller_name">selected</eq> >控制器名称</option>
        <option value="action_name" <eq name="Think.get.search_key" value="action_name">selected</eq> >方法名称</option>
      </select>
      </span>
    </p>
    <input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;搜索&nbsp;&nbsp;"><a href="{:U('list','',false)}?unset=1">&nbsp;<input  class="btn btn-danger radius" type="button" value="重置条件"></a>
  </form>
		
	<div class="cl pd-5 bg-1 bk-gray mt-20"> <span class="l"><a href="javascript:;" onclick="datadel()" class="btn btn-danger radius"><i class="Hui-iconfont">&#xe6e2;</i> 批量删除</a> <a href="javascript:;" onclick="add('{$title}','{$url}','800','500')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe600;</i> {$title}</a></span> <span class="r">共有数据：<strong>{$count}</strong> 条</span> </div>
	<table class="table table-border table-bordered table-bg">
		<thead>
			<tr>
				<th scope="col" colspan="9"></th>
			</tr>
			<tr class="text-c">
				<th width="25"><input type="checkbox" name="" value=""></th>
				<th>ID</th>
        <th>权限名称</th>
        <th>模块名称</th>      
        <th>控制器名称</th>
        <th>方法名称</th>
        <th>父级id</th>
        <th>添加时间</th>
        <th>操作</th>
			</tr>
		</thead>
		<tbody>
			<foreach name="privilegeList" item="val">
			<tr align="center" class="0" id="0_1" id = 'tr_1'>
				<td><input type="checkbox" value="1" name=""></td>
        <td>{$val[id]}</td>
        <td>{$val[pri_name]}</td>
        <td>{$val[moduel_name]}</td>
        <td>{$val[controller_name]}</td>
        <td>{$val[action_name]}</td>
        <td>{$val[parent_id]}</td>
				<td >{$val['addtime'] |date='Y-m-d H:i:s',###}</td>			
				<td class="td-manage"> <a title="编辑" href="javascript:;" onclick="edit('角色编辑','{:U('edit',array('id'=>$val['id']) )}')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a title="删除" href="{:U('del',array('id'=>$val['id'],'lv'=>$val['lv'],'p'=>$p) )}" onclick="del()" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a></td>
			</tr>
			</foreach>
      <tr><td height="30" colspan="10" align="center">{$show}</td></tr>
		</tbody>
	</table>
</div>

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript">
/*
  参数解释：
  title 标题
  url   请求的url
  id    需要操作的数据id
  w   弹出层宽度（缺省调默认值）
  h   弹出层高度（缺省调默认值）
*/
/*管理员-增加*/
function add(title,url,w,h){
  layer_show(title,url,w,h);
}
function del() { 
  var msg = "您真的确定要删除吗？\n\n请确认！"; 
  if (confirm(msg)==true){ 
    return true; 
  }else{ 
    return false; 
  } 
} 

/*管理员-编辑*/
function edit(title,url,id,w,h){
  layer_show(title,url,w,h);
}


//ajax无刷新修改是否显示
$('td[show]').click(function(){
  var td = $(this);
  var show = $(this).attr('show');
  var id = td.prev().prev().prev().prev().prev().prev().prev().html();
  $.ajax({
    type:'GET',
    url:"{:U('ajaxIsUse','',false)}/id/" +id,
    dataType:'json',
    success:function(data){
      if(data!=null){
        str =(data==1)? 1:0;
        td.children().attr('src','__PUBLIC__/Admin/images/'+str+'.gif');
      }
    }
  })
});

//是否显示按钮点击提交表单
$('input[name="is_use"]').click(function(){
  $(this).parent().parent().submit();
});
</script>
</body>
</html>
